(function(){"use strict";function getErrorMessage(e,t){try{var n=JSON.parse(e);if(n&&n.error)return n.error}catch(e){}return t}this.cronapi={},this.doEval=function(e){return e},this.evalInContext=function(js){var result=eval("doEval("+js+")");if(result&&result.commands)for(var i=0;i<result.commands.length;i++){var func=eval(result.commands[i].function);func.apply(this,result.commands[i].params)}if(result&&result.value)return result.value},this.cronapi.conversion={},this.cronapi.conversion.asciiToBinary=function(e){var t="";if(e.length>0)for(var n=0;n<e.length;n++)for(var r=e.charCodeAt(n),o=7;o>=0;o--)t+=r>>o&1;return t},this.cronapi.conversion.toBoolean=function(e){return parseBoolean(e)},this.cronapi.conversion.toBytes=function(e){return e?e.toString():""},this.cronapi.conversion.chrToAscii=function(e){return e?e.charCodeAt(0):null},this.cronapi.conversion.stringToJs=function(e){return stringToJs(e)},this.cronapi.conversion.stringToDate=function(value){var pattern=/^\s*(\d+)[\/\.-](\d+)[\/\.-](\d+)(\s(\d+):(\d+):(\d+))?\s*$/;if(value){if(value instanceof Date)return value;if(pattern.test(value)){var splited=pattern.exec(value),userLang=(navigator.language||navigator.userLanguage).split("-")[0];if("pt"==userLang||"en"==userLang){var functionToCall=eval(userLang+"Date");return functionToCall(splited)}return new Date(value)}return new Date(value)}return null},this.cronapi.conversion.intToHex=function(e){return Number(e).toString(16).toUpperCase()},this.cronapi.conversion.toLong=function(e){return parseInt(e)},this.cronapi.conversion.toString=function(e){return e?new String(e).toString():""},this.cronapi.util={},this.cronapi.util.callServerBlocklyAsync=function(e,t,n,r){var o="api/cronapi/call/body/#classNameWithMethod#/".replace("#classNameWithMethod#",e),i=(cronapi.$scope.http,[]);$(arguments).each(function(){i.push(this)});var a="";window.uToken&&(a=window.uToken);var c={fields:t,inputs:i.slice(4)};$.ajax({type:"POST",url:o,dataType:"html",data:JSON.stringify(c),headers:{"Content-Type":"application/json","X-AUTH-TOKEN":a,toJS:!0},success:n,error:r})},this.cronapi.util.getScreenFields=function(){var e={};for(var t in cronapi.$scope)cronapi.$scope[t]&&cronapi.$scope[t].constructor&&"DataSet"==cronapi.$scope[t].constructor.name&&(e[t]={},e[t].active=cronapi.$scope[t].active);for(var t in cronapi.$scope.vars)cronapi.$scope.vars[t]&&(e.vars||(e.vars={}),e.vars[t]=cronapi.$scope.vars[t]);for(var t in cronapi.$scope.params)cronapi.$scope.params[t]&&(e.params||(e.params={}),e.params[t]=cronapi.$scope.params[t]);return e},this.cronapi.util.makeCallServerBlocklyAsync=function(blocklyWithFunction,callbackSuccess,callbackError){var fields=this.getScreenFields(),paramsApply=[];paramsApply.push(blocklyWithFunction),paramsApply.push(fields),paramsApply.push(function(data){var result=evalInContext(data);"string"==typeof callbackSuccess?eval(callbackSuccess)(result):callbackSuccess&&callbackSuccess(result)}),paramsApply.push(function(data,status,errorThrown){var message=getErrorMessage(data.responseText,errorThrown);"string"==typeof callbackError?eval(callbackError)(message):callbackError?callbackError(message):cronapi.$scope.Notification.error(message)}),$(arguments).each(function(e){e>=3&&paramsApply.push(this)}),cronapi.util.callServerBlocklyAsync.apply(this,paramsApply)},this.cronapi.util.callServerBlocklyNoReturn=function(){cronapi.util.callServerBlockly.apply(this,arguments)},this.cronapi.util.throwException=function(e){throw e},this.cronapi.util.createException=function(e){return e},this.cronapi.util.callServerBlockly=function(e){for(var t="api/cronapi/call/body/#classNameWithMethod#/".replace("#classNameWithMethod#",e),n=[],r={fields:this.getScreenFields(),inputs:n},o=1;o<arguments.length;o++)n.push(arguments[o]);var i="";window.uToken&&(i=window.uToken);var a=$.ajax({type:"POST",url:t,dataType:"html",data:JSON.stringify(r),async:!1,headers:{"Content-Type":"application/json","X-AUTH-TOKEN":i,toJS:!0}});if(200!=a.status){var c=getErrorMessage(a.responseText,a.statusText);throw cronapi.$scope.Notification.error(c),c}return a.responseJSON?a.responseJSON:evalInContext(a.responseText)},this.cronapi.util.executeJavascriptNoReturn=function(value){eval(value)},this.cronapi.util.executeJavascriptNoReturn=function(value){return eval(value)},this.cronapi.screen={},this.cronapi.screen.fieldFromScreen=function(e){return e},this.cronapi.screen.changeValueOfField=function(e,t){try{cronapi.$scope.__tempValue=t;var n=new Function("cronapi.$scope."+e+" = cronapi.$scope.__tempValue;");cronapi.$scope.safeApply(n.bind(cronapi.$scope))}catch(e){alert(e)}},this.cronapi.screen.getValueOfField=function(field){try{return field&&field.length>0?field.indexOf("vars.")>-1?eval("cronapi.$scope."+field):eval(field):""}catch(e){alert(e)}},this.cronapi.screen.createScopeVariable=function(e,t){cronapi.$scope.vars[e]=t},this.cronapi.screen.getScopeVariable=function(e){return cronapi.$scope.vars[e]},this.cronapi.screen.notify=function(e,t){cronapi.$scope.Notification({message:t},e)},this.cronapi.screen.datasourceFromScreen=function(e){return e},this.cronapi.screen.startInsertingMode=function(e){window[e].startInserting(),window[e].$apply()},this.cronapi.screen.startEditingMode=function(e){window[e].$apply(new function(){window[e].startEditing()})},this.cronapi.screen.previusRecord=function(e){window[e].$apply(new function(){window[e].previous()})},this.cronapi.screen.nextRecord=function(e){window[e].$apply(new function(){window[e].next()})},this.cronapi.screen.removeRecord=function(e){window[e].$apply(new function(){window[e].remove()})},this.cronapi.screen.hasNextRecord=function(e){return window[e].hasNext()},this.cronapi.screen.quantityRecords=function(e){return window[e].data.length},this.cronapi.screen.post=function(e){return window[e].post()},this.cronapi.screen.filter=function(e,t){window[e].filter("/"+t)},this.cronapi.screen.changeView=function(e,t){try{var n="?";$(t).each(function(e){for(var t in this)n+="#key#=#value#&".replace("#key#",Url.encode(t)).replace("#value#",Url.encode(this[t]))}),window.location.hash=e+n}catch(e){alert(e)}},this.cronapi.screen.openUrl=function(e,t,n,r){try{var o="_self",i="";t&&"true"==t.toString().toLowerCase()&&(o="_blank"),n&&(i+="width="+n+","),r&&(i+="height="+r+","),window.open(e,o,i)}catch(e){alert(e)}},this.cronapi.screen.getParam=function(e){try{return cronapi.$scope.params[e]}catch(e){alert(e)}},this.cronapi.screen.confimDialog=function(e){return confirm(e)},this.cronapi.screen.createDefaultModal=function(e,t,n,r,o,i,a){$("#modalTemplateTitle").text(e),$("#modalTemplateBody").text(t),$("#modalTemplateCancel").text(n),$("#modalTemplateSave").text(r),$("#modalTemplateClose").unbind("click"),$("#modalTemplateClose").click(a),$("#modalTemplateCancel").unbind("click"),$("#modalTemplateCancel").click(i),$("#modalTemplateSave").unbind("click"),$("#modalTemplateSave").click(o),$("#modalTemplate").modal("show")},this.cronapi.dateTime={},this.cronapi.dateTime.getSecond=function(e){var t=cronapi.conversion.stringToDate(e);return t?t.getSeconds():0},this.cronapi.dateTime.getMinute=function(e){var t=cronapi.conversion.stringToDate(e);return t?t.getMinutes():0},this.cronapi.dateTime.getHour=function(e){var t=cronapi.conversion.stringToDate(e);return t?t.getHours():0},this.cronapi.dateTime.getYear=function(e){var t=cronapi.conversion.stringToDate(e);return t?t.getFullYear():0},this.cronapi.dateTime.getMonth=function(e){var t=cronapi.conversion.stringToDate(e);return t?t.getMonth()+1:0},this.cronapi.dateTime.getDay=function(e){var t=cronapi.conversion.stringToDate(e);return t?t.getDate():0},this.cronapi.dateTime.getDaysBetweenDates=function(e,t){var n=cronapi.conversion.stringToDate(e),r=cronapi.conversion.stringToDate(t);return Math.round((n.getTime()-r.getTime())/864e5)},this.cronapi.dateTime.getMonthsBetweenDates=function(e,t){var n=0,r=0,o=cronapi.conversion.stringToDate(e),i=cronapi.conversion.stringToDate(t);return o&&i&&(r=12*(o.getFullYear()-i.getFullYear()),n=o.getMonth()-i.getMonth(),n+=r,i<o&&o.getDate()<i.getDate()?n--:i>o&&o.getDate()>i.getDate()&&n++),n},this.cronapi.dateTime.getYearsBetweenDates=function(e,t){var n=0,r=cronapi.conversion.stringToDate(e),o=cronapi.conversion.stringToDate(t);return r&&o&&(n=r.getFullYear()-o.getFullYear(),o<r&&(r.getDate()<o.getDate()||r.getMonth()<o.getMonth())?n--:o>r&&(r.getDate()>o.getDate()||r.getMonth()>o.getMonth())&&n++),n},this.cronapi.dateTime.incDay=function(e,t){var n=cronapi.conversion.stringToDate(e);return n.setDate(n.getDate()+t),n},this.cronapi.dateTime.incMonth=function(e,t){var n=cronapi.conversion.stringToDate(e);return n.setMonth(n.getMonth()+t),n},this.cronapi.dateTime.incYear=function(e,t){var n=cronapi.conversion.stringToDate(e);return n.setFullYear(n.getFullYear()+t),n},this.cronapi.dateTime.getNow=function(){return new Date},this.cronapi.dateTime.formatDateTime=function(date,format){for(var dateVar=cronapi.conversion.stringToDate(date),dd=dateVar.getDate(),mm=dateVar.getMonth()+1,yyyy=dateVar.getFullYear(),separator="",maskChars="dmy",i=0;i<format.length;i++)if(!maskChars.includes(format.toLowerCase().charAt(i))){separator=format.toLowerCase().charAt(i);var formatLower=replaceAll(format.toLowerCase(),separator,"+separator+");return eval(formatLower)}return""},this.cronapi.dateTime.newDate=function(e,t,n,r,o,i){var a=new Date;return a.setYear(e),a.setMonth(t-1),a.setDate(n),a.setHours(r),a.setMinutes(o),a.setSeconds(i),a},this.cronapi.dateTime.getValueIsNotNumber=function(e){for(var t=0;t<e.length;t++)if(!"0123456789".includes(e.charAt(t)))return e.charAt(t);return""},this.cronapi.text={},this.cronapi.text.prompt=function(e){return null},this.cronapi.xml={},this.cronapi.xml.newXMLEmpty=function(){return $.parseXML('<?xml version="1.0" encoding="UTF-8"?><root></root>')},this.cronapi.xml.newXMLEmptyWithRoot=function(e){var t=$.parseXML('<?xml version="1.0" encoding="UTF-8"?><root></root>');return t.removeChild(t.firstElementChild),t.appendChild(t.createElement(e)),t},this.cronapi.xml.newXMLElement=function(e,t){var n=document.createElement(e);return n.textContent=t,n},this.cronapi.xml.addXMLElement=function(e,t){try{var n=t.cloneNode(!0);return e.appendChild(n),!0}catch(e){return!1}},this.cronapi.xml.XMLHasRootElement=function(e){return!(!e||!e.getRootNode())},this.cronapi.xml.XMLGetRootElement=function(e){return e instanceof XMLDocument?e.firstElementChild:e.getRootNode()},this.cronapi.xml.XMLDocumentToText=function(e){if(e instanceof XMLDocument)return $($($(e.firstElementChild).context.outerHTML).removeAttr("xmlns"))[0].outerHTML;if($(e).size()>1){var t="";return $.each($(e).toArray(),function(e,n){t+=$($(n)[0].outerHTML).removeAttr("xmlns")[0].outerHTML}),t}return $($($(e).context.outerHTML).removeAttr("xmlns"))[0].outerHTML},this.cronapi.xml.getChildren=function(e,t){return e instanceof XMLDocument?e.firstElementChild.toArray:t?t.localName?$(e).find(t.localName).toArray():$(e).find(t).toArray():$(e).children().toArray()},this.cronapi.xml.setAttribute=function(e,t,n){return!!t&&(e instanceof XMLDocument?(e.firstChild.setAttribute(t,n),!0):!!e&&(e.setAttribute(t,n),!0))},this.cronapi.xml.getAttributeValue=function(e,t){return t?e instanceof XMLDocument?e.firstChild.getAttribute(t)?e.firstChild.getAttribute(t):"":e&&t?e.getAttribute(t):"":""},this.cronapi.xml.getParentNode=function(e){return e instanceof XMLDocument?e.firstChild:e.parentNode},this.cronapi.xml.setElementContent=function(e,t){e instanceof XMLDocument&&(e.firstChild.textContent=t),e.textContent=t},this.cronapi.xml.getElementContent=function(e){return e instanceof XMLDocument?e.firstChild.innerText:e.innerText},this.cronapi.xml.removeElement=function(e,t){e instanceof XMLDocument?t?t instanceof HTMLUnknownElement?t.remove():$.each($(e.firstElementChild.children),function(e,n){n.localName==t&&n.remove()}):$.each($(e.firstElementChild.children),function(e,t){t.remove()}):t?t instanceof HTMLUnknownElement?t.remove():$.each($(e.children),function(e,n){n.localName==t&&n.remove()}):$.each($(e.children),function(e,t){t.remove()})},this.cronapi.xml.getElementName=function(e){return e instanceof XMLDocument?e.firstChild.localName:e.localName},this.cronapi.xml.renameElement=function(e,t){var n=e.outerHTML.replace(e.localName,t);n=n.replace("/"+e.localName,"/"+t),n=$(n).removeAttr("xmlns"),e.replaceWith(n[0])},this.cronapi.logic={},this.cronapi.logic.isNull=function(e){return null===e||void 0===e},this.cronapi.logic.isEmpty=function(e){return""===e},this.cronapi.logic.isNullOrEmpty=function(e){return cronapi.logic.isNull(e)||cronapi.logic.isEmpty(e)},this.cronapi.i18n={},this.cronapi.i18n.translate=function(e,t){if(e){for(var n=cronapi.$translate.instant(e),r=0;r<t.length;r++){var o=t[r];if(null!=o&&void 0!==o){var i=new RegExp("\\{"+r+"\\}","g");n=n.replace(i,o)}}return n}};var ptDate=function(e){var t=e[1],n=e[2],r=e[3],o=e[5],i=e[6],a=e[7];return o?new Date(r,n-1,t,o,i,a):new Date(r,n-1,t,0,0,0)},enDate=function(e){var t=e[1],n=e[2],r=e[3],o=e[5],i=e[6],a=e[7];return o?new Date(r,t-1,n,o,i,a):new Date(r,t-1,n,0,0,0)},parseBoolean=function(e){return!!e&&("boolean"==typeof e?e:"1"==(e=e.toString().toLowerCase().trim())||"true"==e)},removeAccents=function(e){for(withAccents="áàãâäéèêëíìîïóòõôöúùûüçÁÀÃÂÄÉÈÊËÍÌÎÏÓÒÕÖÔÚÙÛÜÇ",withoutAccents="aaaaaeeeeiiiiooooouuuucAAAAAEEEEIIIIOOOOOUUUUC",newValue="",i=0;i<e.length;i++)withAccents.search(e.substr(i,1))>=0?newValue+=withoutAccents.substr(withAccents.search(e.substr(i,1)),1):newValue+=e.substr(i,1);return newValue},arrayRemove=function(e,t){var n=arrayIndexOf(e,t);-1!=n&&e.splice(n,1)},arrayIndexOf=function(e,t){var n=-1;return $(e).each(function(e){t==this&&(n=e)}),n},replaceAll=function(e,t,n){return e.toString().split(t).join(n)},getWindowHeight=function(){$(window).height()},getWindowWidth=function(){$(window).width()},Url={encode:function(e){return e?escape(this._utf8_encode(e)):""},decode:function(e){return e?this._utf8_decode(unescape(e)):""},_utf8_encode:function(e){e=e.replace(/\r\n/g,"\n");for(var t="",n=0;n<e.length;n++){var r=e.charCodeAt(n);r<128?t+=String.fromCharCode(r):r>127&&r<2048?(t+=String.fromCharCode(r>>6|192),t+=String.fromCharCode(63&r|128)):(t+=String.fromCharCode(r>>12|224),t+=String.fromCharCode(r>>6&63|128),t+=String.fromCharCode(63&r|128))}return t},_utf8_decode:function(e){for(var t="",n=0,r=c1=c2=0;n<e.length;)(r=e.charCodeAt(n))<128?(t+=String.fromCharCode(r),n++):r>191&&r<224?(c2=e.charCodeAt(n+1),t+=String.fromCharCode((31&r)<<6|63&c2),n+=2):(c2=e.charCodeAt(n+1),c3=e.charCodeAt(n+2),t+=String.fromCharCode((15&r)<<12|(63&c2)<<6|63&c3),n+=3);return t}},stringToJs=function(e){return(e+"").replace(/[\\"']/g,"\\$&").replace(/\u0000/g,"\\0")}}).bind(window)();